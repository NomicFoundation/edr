name: EDR

on:
  push:
    branches:
      - main
      - chore/871-add-ci-actions
  workflow_dispatch:


concurrency:
  group: ${{github.workflow}}-${{github.ref}}
  cancel-in-progress: true

jobs:
  edr-op-chain-configs:
    name: Check that op-chain config files are up to date
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout EDR repo
        uses: actions/checkout@v4
        with:
          ref: main

      - name: Setup Rust & install nightly rustfmt
        uses: ./.github/actions/setup-rust
        with:
          toolchain: nightly
          components: rustfmt

      - name: Run op-chain-config command that updates chains config
        run: cargo op-chain-config

      - name: Check that there are no uncommitted changes
        run: git diff --exit-code
